using Base.Test
include("eegutilities.jl")

@testset "Normalize Tests" begin
@test normalize([2 4 8]) == [.25 .5 1]
@test normalize([1, 2, 4]) == [0.25, 0.5, 1]
end

@testset "Threshold_01 Tests" begin
@test threshold_01([1 2 3 4 5 6 7 8 9 10.5], 4) == [0 0 0 1 1 1 1 1 1 1]
@test threshold_01([1 2 3; 4 5 6], 3) == [0 0 1; 1 1 1]
end

#TODO highpass and lowpass tests aren't working yet
@testset "Lowpass Tests" begin
q = linspace(0,1,150)
sindata = sin(60*2*pi*q) + sin(200*2*pi*q)
@test lowpass(sindata, 65, 150) ≈ [0.0,0.711807,0.0259839,-0.975665,1.10404,-0.266894,-0.817462,1.2731,-0.830233,-0.00388833,0.474928,-0.294331,-0.127566,0.131324,0.494892,-1.24063,1.30234,-0.3434,-1.11172,2.03636,-1.73001,0.403479,0.990168,-1.53267,1.05255,-0.170022,-0.326774,0.187764,0.146564,-0.057529,-0.578833,1.20748,-1.09105,0.0398849,1.30793,-1.94926,1.34437,0.109491,-1.3826,1.63989,-0.880675,-0.145501,0.640093,-0.431112,0.0290523,-0.0487216,0.562061,-1.0003,0.705865,0.378596,-1.5413,1.84767,-0.943116,-0.598214,1.70438,-1.65841,0.644115,0.471603,-0.904333,0.580079,-0.0871836,0.0373838,-0.452516,0.753216,-0.356764,-0.68333,1.61517,-1.60002,0.469317,1.05686,-1.91132,1.53142,-0.291677,-0.846094,1.14483,-0.652989,0.045267,0.0708032,0.274755,-0.49042,0.0591665,0.877333,-1.55685,1.25518,0.0192156,-1.43709,1.98116,-1.27002,-0.137022,1.21539,-1.31188,0.618731,0.101543,-0.254796,-0.068185,0.2569,0.151432,-0.947541,1.38137,-0.851255,-0.476165,1.7033,-1.90356,0.892885,0.602726,-1.53563,1.37341,-0.467586,-0.338509,0.481058,-0.125787,-0.0886588,-0.256776,0.901045,-1.12046,0.434207,0.858529,-1.83267,1.68534,-0.433655,-1.05874,1.7654,-1.30818,0.20466,0.63762,-0.709072,0.26752,0.011774,0.253274,-0.759136,0.814273,-0.0492975,-1.13323,1.81802,-1.3489,-0.0644496,1.45837,-1.8727,1.11016,0.149495,-0.96064,0.896747,-0.324851,-0.0384044,-0.152911,0.554886,-0.506679,-0.264163,1.28082,-1.66855]
end

@testset "Highpass Tests" begin
q = linspace(0,1,410)
sindata = sin(60*2*pi*q) + sin(200*2*pi*q)
@test highpass(sindata, 200, 410) ≈ [0.0,1.03108e-7,-1.14123e-6,6.28374e-6,-2.32281e-5,6.55812e-5,-0.000152309,0.000305471,-0.000547505,0.000899177,-0.00137845,0.00199974,-0.00277311,0.00370387,-0.00479312,0.00603985,-0.00744357,0.0090059,-0.0107299,0.0126174,-0.0146654,0.0168648,-0.0192002,0.021653,-0.0242035,0.0268325,-0.0295218,0.0322548,-0.0350156,0.0377902,-0.0405645,0.0433232,-0.0460475,0.0487145,-0.0512993,0.0537778,-0.0561305,0.0583436,-0.0604077,0.0623157,-0.0640596,0.0656303,-0.0670174,0.0682103,-0.0691983,0.0699716,-0.0705224,0.0708464,-0.0709448,0.0708235,-0.0704914,0.0699568,-0.069225,0.0682976,-0.0671746,0.0658579,-0.0643529,0.0626693,-0.0608199,0.0588196,-0.0566842,0.0544295,-0.0520706,0.0496201,-0.0470874,0.0444795,-0.0418032,0.0390684,-0.0362896,0.0334856,-0.0306759,0.0278782,-0.0251058,0.0223682,-0.0196723,0.0170242,-0.0144299,0.0118964,-0.0094317,0.00704581,-0.00475084,0.00255961,-0.00048305,-0.00147247,0.00330609,-0.00502093,0.00662082,-0.00810715,0.00947768,-0.0107275,0.0118514,-0.0128451,0.0137071,-0.0144381,0.0150416,-0.0155235,0.0158924,-0.0161573,0.0163255,-0.0164004,0.0163815,-0.0162667,0.0160554,-0.0157515,0.0153636,-0.014903,0.0143813,-0.0138082,0.0131911,-0.0125349,0.0118431,-0.0111173,0.0103586,-0.00956853,0.00875169,-0.00791648,0.00707453,-0.00623787,0.00541548,-0.00461135,0.00382501,-0.00305404,0.00229697,-0.00155492,0.000831644,-0.000132638,-0.00053574,0.00116693,-0.00175499,0.00229601,-0.00278956,0.00323919,-0.00365092,0.0040302,-0.00437895,0.00469442,-0.00497061,0.00520137,-0.00538325,0.00551666,-0.00560518,0.00565406,-0.00566898,0.00565523,-0.00561704,0.00555651,-0.0054728,0.00536231,-0.00522062,0.00504542]
end

@testset "Downsample Tests" begin
@test dsample([1,2,3,4,5,6,7,8], 1/2) = [1,3,5,7]
end
